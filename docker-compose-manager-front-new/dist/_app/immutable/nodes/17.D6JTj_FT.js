import{c as ge,a as u,f as M,t as K,e as ir,d as dr}from"../chunks/AQshOrwM.js";import{f as O,p as Ge,b as Qe,k as Te,u as lr,d as pe,a as He,g as e,c as t,r,s as a,n as Z,t as g,e as E}from"../chunks/BGIsFGxD.js";import{s as i}from"../chunks/CK6JJk40.js";import{r as je,c as ur,e as cr,s as ze}from"../chunks/BIIYjbM9.js";import{l as vr,s as pr,p as mr,i as ee,a as Je,b as Oe}from"../chunks/BBZnTf8d.js";import{a as re,L as Me,P as gr}from"../chunks/BG8J9VMA.js";import{L as fr}from"../chunks/BUAbUYdX.js";import{C as _r}from"../chunks/B4PLRw1v.js";import{c as Ne}from"../chunks/jbU8H10p.js";import{I as xr,s as br,t as Re}from"../chunks/DNE0aubT.js";import{B as Ae}from"../chunks/BZEFvVZa.js";import{I as yr}from"../chunks/FLXc8Hxn.js";import{X as hr}from"../chunks/Dkv5VvjD.js";import"../chunks/B9IV9xzZ.js";import{P as wr}from"../chunks/Bmet6DEc.js";import"../chunks/lu7k8_0b.js";import"../chunks/BUApaBEI.js";import"../chunks/CVCFcqur.js";import"../chunks/DXzkz7Sz.js";import{u as Ve}from"../chunks/ygxaYeff.js";import{c as me}from"../chunks/Bri70JPp.js";import{t as $}from"../chunks/CUtoxrzn.js";import{B as Xe}from"../chunks/BvXwocyZ.js";import{c as kr}from"../chunks/Dw9yDBlQ.js";import{P as $r}from"../chunks/DiIcC3HA.js";import{U as Pr}from"../chunks/CGIVq8FV.js";import{S as Cr}from"../chunks/CvOlKTIm.js";import{T as Er}from"../chunks/BJjaivRV.js";function Ur(te,b){const s=vr(b,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"M20 6 9 17l-5-5"}]];xr(te,pr({name:"check"},()=>s,{get iconNode(){return se},children:(ae,c)=>{var p=ge(),Q=O(p);br(Q,b,"default",{}),u(ae,p)},$$slots:{default:!0}}))}var qr=M('<div class="fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"><div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 w-full max-w-3xl max-h-[90vh] overflow-auto"><div class="p-6 border-b border-gray-200 dark:border-gray-700"><h2 class="text-2xl font-bold text-gray-900 dark:text-white"> </h2></div> <form class="p-6 space-y-6"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <select id="role" class="w-full border border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"><option>User</option><option>Admin</option></select></div> <div class="grid grid-cols-2 gap-4"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="h-4 w-4"/> <span class="text-sm font-medium text-gray-900 dark:text-white"> </span></label> <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="h-4 w-4"/> <span class="text-sm font-medium text-gray-900 dark:text-white"> </span></label></div> <div class="border-t border-gray-200 dark:border-gray-700 pt-6"><!></div> <div class="flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"><!> <!></div></form></div></div>');function Dr(te,b){Ge(b,!0);const s=()=>Oe(Re,"$t",se),[se,ae]=Je();let c=mr(b,"user",3,void 0);const p=E(()=>!!c()),Q=Ve();let o=Qe(Te({username:c()?.username||"",password:"",role:c()?.role||"user",isEnabled:c()?.isEnabled??!0,mustChangePassword:c()?.mustChangePassword??!1,permissions:[]}));lr(()=>{c()&&pe(o,{username:c().username,password:"",role:c().role,isEnabled:c().isEnabled,mustChangePassword:c().mustChangePassword,permissions:[]},!0)});const B=me(()=>({mutationFn:()=>re.create({username:e(o).username,password:e(o).password,role:e(o).role,permissions:e(o).permissions}),onSuccess:()=>{Q.invalidateQueries({queryKey:["users"]}),$.success(s()("users.userCreated")),b.onClose()},onError:v=>{console.error("Full error:",v),console.error("Error response:",v.response),console.error("Error data:",v.response?.data);const U=v.response?.data?.message||v.response?.data?.title||v.message||s()("users.failedToCreate");$.error(U)}})),L=me(()=>({mutationFn:()=>re.update(c().id,{username:e(o).username,newPassword:e(o).password||void 0,role:e(o).role,isEnabled:e(o).isEnabled,permissions:e(o).permissions}),onSuccess:()=>{Q.invalidateQueries({queryKey:["users"]}),$.success(s()("users.userUpdated")),b.onClose()},onError:v=>{$.error(v.response?.data?.message||s()("users.failedToUpdate"))}}));function fe(v){if(v.preventDefault(),!e(o).username||!e(p)&&!e(o).password){$.error("Please fill in all required fields");return}e(p)?L.mutate():B.mutate()}function Pe(v){e(o).permissions=v}var _e=ge(),xe=O(_e);{var oe=v=>{var U=qr(),R=t(U),ne=t(R),ie=t(ne),Ce=t(ie,!0);r(ie),r(ne);var de=a(ne,2),le=t(de),be=t(le);Me(be,{for:"username",children:(n,f)=>{Z();var _=K();g(x=>i(_,`${x??""} *`),[()=>s()("users.username")]),u(n,_)},$$slots:{default:!0}});var Ee=a(be,2);{let n=E(()=>s()("users.username"));yr(Ee,{id:"username",type:"text",get placeholder(){return e(n)},required:!0,get value(){return e(o).username},set value(f){e(o).username=f}})}r(le);var V=a(le,2),ye=t(V);Me(ye,{for:"password",children:(n,f)=>{Z();var _=K();g((x,X)=>i(_,`${x??""} ${X??""}`),[()=>s()("users.password"),()=>e(p)?`(${s()("common.optional")})`:"*"]),u(n,_)},$$slots:{default:!0}});var d=a(ye,2);{let n=E(()=>e(p)?s()("users.leaveBlankToKeepCurrent"):s()("users.password")),f=E(()=>!e(p));wr(d,{id:"password",get placeholder(){return e(n)},get required(){return e(f)},get value(){return e(o).password},set value(_){e(o).password=_}})}r(V);var y=a(V,2),I=t(y);Me(I,{for:"role",children:(n,f)=>{Z();var _=K();g(x=>i(_,`${x??""} *`),[()=>s()("users.role")]),u(n,_)},$$slots:{default:!0}});var T=a(I,2),j=t(T);j.value=j.__value="user";var w=a(j);w.value=w.__value="admin",r(T),r(y);var P=a(y,2),z=t(P),N=t(z);je(N);var he=a(N,2),A=t(he,!0);r(he),r(z);var C=a(z,2),q=t(C);je(q);var D=a(q,2),W=t(D,!0);r(D),r(C),r(P);var S=a(P,2),Ue=t(S);{let n=E(()=>e(p)&&!!b.onCopyPermissionsClick);gr(Ue,{get permissions(){return e(o).permissions},onChange:Pe,get onCopyClick(){return b.onCopyPermissionsClick},get showCopyButton(){return e(n)}})}r(S);var Y=a(S,2),we=t(Y);{let n=E(()=>B.isPending||L.isPending);Ae(we,{type:"submit",get disabled(){return e(n)},class:"flex-1",children:(f,_)=>{var x=ge(),X=O(x);{var ke=l=>{var k=K();g(F=>i(k,`${F??""}...`),[()=>s()("common.saving")]),u(l,k)},G=l=>{var k=K();g(F=>i(k,F),[()=>e(p)?s()("common.update"):s()("common.create")]),u(l,k)};ee(X,l=>{B.isPending||L.isPending?l(ke):l(G,!1)})}u(f,x)},$$slots:{default:!0}})}var ue=a(we,2);{let n=E(()=>B.isPending||L.isPending);Ae(ue,{type:"button",variant:"outline",get onclick(){return b.onClose},get disabled(){return e(n)},class:"flex-1",children:(f,_)=>{Z();var x=K();g(X=>i(x,X),[()=>s()("common.cancel")]),u(f,x)},$$slots:{default:!0}})}r(Y),r(de),r(R),r(U),g((n,f,_)=>{i(Ce,n),i(A,f),i(W,_)},[()=>e(p)?s()("users.editUser"):s()("users.createUser"),()=>s()("users.enabled"),()=>s()("users.mustChangePassword")]),ir("submit",de,fe),ur(T,()=>e(o).role,n=>e(o).role=n),Ne(N,()=>e(o).isEnabled,n=>e(o).isEnabled=n),Ne(q,()=>e(o).mustChangePassword,n=>e(o).mustChangePassword=n),u(v,U)};ee(xe,v=>{b.open&&v(oe)})}u(te,_e),He(),ae()}var Sr=M("<!> ",1),Fr=M('<div class="text-center py-8 text-red-500"> </div>'),Mr=M('<div class="text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow"><!> <p class="text-gray-600 dark:text-gray-400"> </p></div>'),Qr=M('<button class="p-2 text-yellow-600 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 rounded-lg transition-colors cursor-pointer" title="Disable"><!></button>'),Tr=M('<button class="p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded-lg transition-colors cursor-pointer" title="Enable"><!></button>'),Ar=M('<tr class="hover:bg-gray-50 dark:hover:bg-gray-700/50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center gap-3"><div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold text-sm"> </div> <span class="font-medium text-gray-900 dark:text-white"> </span></div></td><td class="px-6 py-4 whitespace-nowrap"><!></td><td class="px-6 py-4 whitespace-nowrap"><!></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"> </td><td class="px-6 py-4 whitespace-nowrap text-right"><div class="flex justify-end gap-2"><button class="p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors cursor-pointer"><!></button> <!> <button class="p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors cursor-pointer"><!></button></div></td></tr>'),Kr=M('<div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden"><table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700"><thead class="bg-gray-50 dark:bg-gray-900"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"> </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"> </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"> </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"> </th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"> </th></tr></thead><tbody class="divide-y divide-gray-200 dark:divide-gray-700"></tbody></table></div>'),Br=M('<div class="space-y-6"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"><div><h1 class="text-3xl font-bold text-gray-900 dark:text-white"> </h1> <p class="text-gray-600 dark:text-gray-400 mt-1"> </p></div> <!></div> <!></div> <!> <!>',1);function pt(te,b){Ge(b,!0);const s=()=>Oe(Re,"$t",se),[se,ae]=Je();let c=Qe(Te({open:!1,title:"",description:"",onConfirm:()=>{}})),p=Qe(Te({open:!1,user:void 0}));const Q=Ve(),o=kr(()=>({queryKey:["users"],queryFn:()=>re.list()})),B=me(()=>({mutationFn:d=>re.enable(d),onSuccess:()=>{Q.invalidateQueries({queryKey:["users"]}),$.success(s()("users.userStatusUpdated"))},onError:()=>$.error(s()("users.failedToUpdate"))})),L=me(()=>({mutationFn:d=>re.disable(d),onSuccess:()=>{Q.invalidateQueries({queryKey:["users"]}),$.success(s()("users.userStatusUpdated"))},onError:()=>$.error(s()("users.failedToUpdate"))})),fe=me(()=>({mutationFn:d=>re.delete(d),onSuccess:()=>{Q.invalidateQueries({queryKey:["users"]}),$.success(s()("users.userDeleted"))},onError:()=>$.error(s()("users.failedToDelete"))}));function Pe(d,y){pe(c,{open:!0,title:s()("users.deleteUser"),description:`Are you sure you want to delete user "${y}"?`,onConfirm:()=>{fe.mutate(d),e(c).open=!1}},!0)}function _e(d){return new Date(d).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}var xe=Br(),oe=O(xe),v=t(oe),U=t(v),R=t(U),ne=t(R,!0);r(R);var ie=a(R,2),Ce=t(ie,!0);r(ie),r(U);var de=a(U,2);Ae(de,{onclick:()=>pe(p,{open:!0,user:void 0},!0),children:(d,y)=>{var I=Sr(),T=O(I);$r(T,{class:"w-4 h-4 mr-2"});var j=a(T);g(w=>i(j,` ${w??""}`),[()=>s()("users.createUser")]),u(d,I)},$$slots:{default:!0}}),r(v);var le=a(v,2);{var be=d=>{{let y=E(()=>s()("common.loading"));fr(d,{get message(){return e(y)}})}},Ee=d=>{var y=ge(),I=O(y);{var T=w=>{var P=Fr(),z=t(P,!0);r(P),g(N=>i(z,N),[()=>s()("errors.generic")]),u(w,P)},j=w=>{var P=ge(),z=O(P);{var N=A=>{var C=Mr(),q=t(C);Pr(q,{class:"w-12 h-12 mx-auto text-gray-400 mb-4"});var D=a(q,2),W=t(D,!0);r(D),r(C),g(S=>i(W,S),[()=>s()("users.noUsers")]),u(A,C)},he=A=>{var C=Kr(),q=t(C),D=t(q),W=t(D),S=t(W),Ue=t(S,!0);r(S);var Y=a(S),we=t(Y,!0);r(Y);var ue=a(Y),n=t(ue,!0);r(ue);var f=a(ue),_=t(f,!0);r(f);var x=a(f),X=t(x,!0);r(x),r(W),r(D);var ke=a(D);cr(ke,21,()=>o.data,G=>G.id,(G,l)=>{var k=Ar(),F=t(k),$e=t(F),qe=t($e),We=t(qe,!0);r(qe);var Ke=a(qe,2),Ye=t(Ke,!0);r(Ke),r($e),r(F);var De=a(F),Ze=t(De);{let h=E(()=>e(l).role==="Admin"?"default":"secondary");Xe(Ze,{get variant(){return e(h)},children:(m,H)=>{Z();var J=K();g(()=>i(J,e(l).role)),u(m,J)},$$slots:{default:!0}})}r(De);var Se=a(De),er=t(Se);{let h=E(()=>e(l).isEnabled?"success":"destructive");Xe(er,{get variant(){return e(h)},children:(m,H)=>{Z();var J=K();g(nr=>i(J,nr),[()=>e(l).isEnabled?s()("users.enabled"):s()("users.disabled")]),u(m,J)},$$slots:{default:!0}})}r(Se);var Fe=a(Se),rr=t(Fe,!0);r(Fe);var Be=a(Fe),Le=t(Be),ce=t(Le);ce.__click=()=>pe(p,{open:!0,user:e(l)},!0);var tr=t(ce);Cr(tr,{class:"w-4 h-4"}),r(ce);var Ie=a(ce,2);{var sr=h=>{var m=Qr();m.__click=()=>L.mutate(e(l).id);var H=t(m);hr(H,{class:"w-4 h-4"}),r(m),g(()=>m.disabled=L.isPending),u(h,m)},ar=h=>{var m=Tr();m.__click=()=>B.mutate(e(l).id);var H=t(m);Ur(H,{class:"w-4 h-4"}),r(m),g(()=>m.disabled=B.isPending),u(h,m)};ee(Ie,h=>{e(l).isEnabled?h(sr):h(ar,!1)})}var ve=a(Ie,2);ve.__click=()=>Pe(e(l).id,e(l).username);var or=t(ve);Er(or,{class:"w-4 h-4"}),r(ve),r(Le),r(Be),r(k),g((h,m,H,J)=>{i(We,h),i(Ye,e(l).username),i(rr,m),ze(ce,"title",H),ze(ve,"title",J),ve.disabled=fe.isPending},[()=>e(l).username.charAt(0).toUpperCase(),()=>_e(e(l).createdAt),()=>s()("common.edit"),()=>s()("common.delete")]),u(G,k)}),r(ke),r(q),r(C),g((G,l,k,F,$e)=>{i(Ue,G),i(we,l),i(n,k),i(_,F),i(X,$e)},[()=>s()("users.username"),()=>s()("users.role"),()=>s()("users.status"),()=>s()("users.createdAt"),()=>s()("users.actions")]),u(A,C)};ee(z,A=>{!o.data||o.data.length===0?A(N):A(he,!1)},!0)}u(w,P)};ee(I,w=>{o.error?w(T):w(j,!1)},!0)}u(d,y)};ee(le,d=>{o.isLoading?d(be):d(Ee,!1)})}r(oe);var V=a(oe,2);_r(V,{get open(){return e(c).open},get title(){return e(c).title},get description(){return e(c).description},get onconfirm(){return e(c).onConfirm},oncancel:()=>e(c).open=!1});var ye=a(V,2);Dr(ye,{get open(){return e(p).open},get user(){return e(p).user},onClose:()=>pe(p,{open:!1,user:void 0},!0)}),g((d,y)=>{i(ne,d),i(Ce,y)},[()=>s()("users.title"),()=>s()("users.subtitle")]),u(te,xe),He(),ae()}dr(["click"]);export{pt as component};
