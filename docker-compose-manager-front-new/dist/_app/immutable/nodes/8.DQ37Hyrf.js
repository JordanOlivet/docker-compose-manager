import{c as Ee,a as p,d as tr,f as x}from"../chunks/AQshOrwM.js";import{o as rr,a as ar}from"../chunks/DArI6N9H.js";import{f as F,p as or,b as Me,k as rt,s,t as _,a as sr,c as a,d as oe,g as t,e as A,r}from"../chunks/BGIsFGxD.js";import{s as v}from"../chunks/CK6JJk40.js";import{e as at,s as k,b as nr}from"../chunks/BIIYjbM9.js";import{l as ir,s as cr,i as C,a as dr,b as lr}from"../chunks/BBZnTf8d.js";import{c as V}from"../chunks/C1OtUQtP.js";import{c as se}from"../chunks/BVN2tSMg.js";import{E as u}from"../chunks/B54_NynL.js";import{S as ot}from"../chunks/XOV-vLG0.js";import{L as vr}from"../chunks/BUAbUYdX.js";import{C as ur}from"../chunks/B4PLRw1v.js";import{I as gr}from"../chunks/FLXc8Hxn.js";import{I as pr,s as mr,t as xr}from"../chunks/DNE0aubT.js";import{g as hr}from"../chunks/lu7k8_0b.js";import{c as _r,s as fr,R as st}from"../chunks/Do2vTpg_.js";import{u as br}from"../chunks/ygxaYeff.js";import{c as yr}from"../chunks/Dw9yDBlQ.js";import{c as P}from"../chunks/Bri70JPp.js";import{R as kr}from"../chunks/BLWlkucS.js";import{S as wr}from"../chunks/iUuFbj3C.js";import{t as g}from"../chunks/CUtoxrzn.js";import{S as qe,P as nt}from"../chunks/B8pBSBZ4.js";import"../chunks/CVCFcqur.js";import{Z as $r}from"../chunks/CnqUAwLX.js";import{T as it}from"../chunks/BJjaivRV.js";function Sr(ne,X){const o=ir(X,["children","$$slots","$$events","$$legacy"]);const ie=[["path",{d:"m9 18 6-6-6-6"}]];pr(ne,cr({name:"chevron-right"},()=>o,{get iconNode(){return ie},children:(ce,Y)=>{var T=Ee(),f=F(T);mr(f,X,"default",{}),p(ce,T)},$$slots:{default:!0}}))}var Cr=x('<div class="text-center py-8 text-red-500"> </div>'),Rr=x('<div class="text-center py-12 bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-lg"><div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-700 mb-3"><!></div> <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2"> </h3> <p class="text-sm text-gray-600 dark:text-gray-400"> </p></div>'),Pr=x('<button class="p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors cursor-pointer"><!></button> <button class="p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors cursor-pointer"><!></button>',1),Tr=x('<button class="p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors cursor-pointer"><!></button> <button class="p-1 text-yellow-600 hover:text-yellow-800 dark:text-yellow-400 dark:hover:text-yellow-300 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 rounded transition-colors cursor-pointer"><!></button>',1),Lr=x('<button class="p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors cursor-pointer"><!></button>'),Mr=x("<span> </span>"),qr=x('<button class="p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors cursor-pointer"><!></button> <button class="p-1 text-yellow-600 hover:text-yellow-800 dark:text-yellow-400 dark:hover:text-yellow-300 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 rounded transition-colors cursor-pointer"><!></button>',1),Er=x('<button class="p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors cursor-pointer"><!></button>'),Qr=x('<tr class="hover:bg-white dark:hover:bg-gray-800 transition-all"><td class="px-4 py-2 whitespace-nowrap"><div class="text-xs font-medium text-gray-900 dark:text-white"> </div> <div class="text-[10px] text-gray-500 dark:text-gray-400 font-mono"> </div></td><td class="px-4 py-2"><div class="text-xs text-gray-900 dark:text-gray-300"> </div></td><td class="px-4 py-2 whitespace-nowrap"><!></td><td class="px-4 py-2"><div class="text-xs text-gray-500 dark:text-gray-400"> </div></td><td class="px-4 py-2 whitespace-nowrap text-xs"><div class="flex items-center gap-1"><!> <button class="p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors cursor-pointer"><!></button></div></td></tr>'),Dr=x('<div class="transition-all duration-200 ease-in-out overflow-hidden" style="will-change: max-height, opacity"><div class="bg-gray-50 dark:bg-gray-900 rounded-xl shadow border border-gray-100 dark:border-gray-700 overflow-hidden"><div class="overflow-x-auto"><table class="w-full"><thead class="bg-white/50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700"><tr><th class="px-4 py-2 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider"> </th><th class="px-4 py-2 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider"> </th><th class="px-4 py-2 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider"> </th><th class="px-4 py-2 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider"> </th><th class="px-4 py-2 text-left text-xs font-bold text-gray-700 dark:text-gray-300 uppercase tracking-wider"> </th></tr></thead><tbody class="divide-y divide-gray-100 dark:divide-gray-700"></tbody></table></div></div></div>'),Fr=x('<div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow hover:shadow-lg transition-all duration-300"><div class="px-4 py-2 cursor-pointer group relative" role="button" tabindex="0"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span aria-hidden="true"><!></span> <h3 class="text-base font-semibold"><button class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors cursor-pointer"> </button></h3> <!></div> <div class="flex gap-1"><!> <!> <!></div></div> <div class="mt-1 text-xs text-gray-600 dark:text-gray-400"><!></div></div> <!></div>'),Kr=x('<div class="space-y-2"></div>'),jr=x('<div class="space-y-4"><div class="mb-2"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-1"> </h1> <p class="text-base text-gray-600 dark:text-gray-400"> </p></div> <button class="flex items-center gap-2 px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer"><!> </button></div></div> <div class="relative"><!> <!></div> <div class="mb-2"><p class="text-xs text-gray-600 dark:text-gray-400"> </p></div> <!></div> <!>',1);function va(ne,X){or(X,!0);const o=()=>lr(xr,"$t",ie),[ie,ce]=dr();let Y=Me(""),T=Me(rt({})),f=Me(rt({open:!1,title:"",description:"",onConfirm:()=>{}}));const w=br(),ee=yr(()=>({queryKey:["compose","projects"],queryFn:()=>V.listProjects(),refetchInterval:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,staleTime:6e4}));let de=null,K=null;function le(){K&&clearTimeout(K),K=setTimeout(()=>{w.invalidateQueries({queryKey:["compose","projects"]}),K=null},500)}rr(async()=>{de=_r({onOperationUpdate:e=>{const d=e.status==="completed"||e.status==="failed",$=e.type&&e.type.toLowerCase().includes("compose");d&&$&&le(),e.errorMessage&&g.error(`Operation error: ${e.errorMessage}`)},onContainerStateChanged:e=>{console.log(`Container ${e.containerName} changed state: ${e.action}`),le()},onComposeProjectStateChanged:e=>{console.log(`Compose project ${e.projectName} - service ${e.serviceName} changed state: ${e.action}`),le()},onConnected:()=>{console.log("SignalR connected - listening for compose project updates")},onDisconnected:e=>{e&&console.error("SignalR disconnected with error:",e)},onReconnecting:e=>{console.warn("SignalR reconnecting...",e)}}),await fr()}),ar(()=>{K&&clearTimeout(K),de&&de()});const Qe=P(()=>({mutationFn:({projectName:e,forceRecreate:d})=>V.upProject(e,{detach:!0,forceRecreate:d}),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("compose.upSuccess"))},onError:()=>g.error(o()("compose.failedToLoad"))})),ct=P(()=>({mutationFn:e=>V.downProject(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("compose.downSuccess"))},onError:()=>g.error(o()("compose.failedToLoad"))})),dt=P(()=>({mutationFn:e=>V.restartProject(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("compose.restartSuccess"))},onError:()=>g.error(o()("compose.failedToLoad"))})),lt=P(()=>({mutationFn:e=>V.stopProject(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("compose.stopSuccess"))},onError:()=>g.error(o()("compose.failedToLoad"))})),vt=P(()=>({mutationFn:e=>se.start(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("containers.startSuccess"))},onError:()=>g.error(o()("containers.failedToStart"))})),ut=P(()=>({mutationFn:e=>se.stop(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("containers.stopSuccess"))},onError:()=>g.error(o()("containers.failedToStop"))})),gt=P(()=>({mutationFn:e=>se.restart(e),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("containers.restartSuccess"))},onError:()=>g.error(o()("containers.failedToRestart"))})),pt=P(()=>({mutationFn:({containerId:e,force:d})=>se.remove(e,d),onSuccess:()=>{w.invalidateQueries({queryKey:["compose","projects"]}),g.success(o()("containers.removeSuccess"))},onError:()=>g.error(o()("containers.failedToRemove"))}));function De(e){oe(T,{...t(T),[e]:!t(T)[e]},!0)}function mt(e){hr(`/compose/projects/${encodeURIComponent(e)}`)}function xt(e){const $=e.state===u.Running?`${o()("compose.title")} ${e.name} ${o()("containers.confirmRemoveRunning")}`:`${o()("common.delete")} ${o()("compose.title").toLowerCase()} ${e.name}?`;oe(f,{open:!0,title:o()("common.delete"),description:$,onConfirm:()=>{ct.mutate(e.name),t(f).open=!1}},!0)}function ht(e){const d=e.state===u.Running,$=d?`${o()("containers.title")} ${e.name} ${o()("containers.confirmRemoveRunning")}`:`${o()("containers.confirmRemove")} ${e.name}?`;oe(f,{open:!0,title:o()("containers.remove"),description:$,onConfirm:()=>{pt.mutate({containerId:e.id,force:d}),t(f).open=!1}},!0)}function Fe(e){switch(e){case u.Running:case u.Restarting:return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case u.Exited:case u.Down:case u.Stopped:return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case u.Degraded:default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}}const te=A(()=>(ee.data??[]).filter(e=>e.name.toLowerCase().includes(t(Y).toLowerCase())));var Ke=jr(),ve=F(Ke),ue=a(ve),je=a(ue),ge=a(je),pe=a(ge),_t=a(pe,!0);r(pe);var Ie=s(pe,2),ft=a(Ie,!0);r(Ie),r(ge);var me=s(ge,2);me.__click=()=>ee.refetch();var Ne=a(me);kr(Ne,{class:"w-3 h-3"});var bt=s(Ne);r(me),r(je),r(ue);var xe=s(ue,2),Oe=a(xe);wr(Oe,{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"});var yt=s(Oe,2);{let e=A(()=>o()("common.search"));gr(yt,{type:"text",get placeholder(){return t(e)},class:"pl-10",get value(){return t(Y)},set value(d){oe(Y,d,!0)}})}r(xe);var he=s(xe,2),ze=a(he),kt=a(ze);r(ze),r(he);var wt=s(he,2);{var $t=e=>{{let d=A(()=>o()("common.loading"));vr(e,{get message(){return t(d)}})}},St=e=>{var d=Ee(),$=F(d);{var _e=j=>{var I=Cr(),be=a(I,!0);r(I),_(ye=>v(be,ye),[()=>o()("compose.failedToLoad")]),p(j,I)},fe=j=>{var I=Ee(),be=F(I);{var ye=N=>{var L=Rr(),M=a(L),i=a(M);qe(i,{class:"w-8 h-8 text-gray-400"}),r(M);var q=s(M,2),U=a(q,!0);r(q);var S=s(q,2),Z=a(S,!0);r(S),r(L),_((B,O)=>{v(U,B),v(Z,O)},[()=>o()("compose.noProjects"),()=>o()("compose.noProjectsMessage")]),p(N,L)},Rt=N=>{var L=Kr();at(L,21,()=>t(te),M=>M.name,(M,i)=>{const q=A(()=>t(T)[t(i).name]??!1);var U=Fr(),S=a(U);S.__click=n=>{n.target.closest("button")||De(t(i).name)},S.__keydown=n=>{(n.key==="Enter"||n.key===" ")&&De(t(i).name)};var Z=a(S),B=a(Z),O=a(B);let Ae;var Pt=a(O);Sr(Pt,{class:"w-4 h-4"}),r(O);var ke=s(O,2),we=a(ke);we.__click=n=>{n.stopPropagation(),mt(t(i).name)};var Tt=a(we,!0);r(we),r(ke);var Lt=s(ke,2);{let n=A(()=>Fe(t(i).state));ot(Lt,{get class(){return`${t(n)??""} text-xs px-2 py-0.5`},get status(){return t(i).state},size:"sm"})}r(B);var Ue=s(B,2),Ze=a(Ue);{var Mt=n=>{var c=Pr(),l=F(c);l.__click=()=>Qe.mutate({projectName:t(i).name});var b=a(l);nt(b,{class:"w-4 h-4"}),r(l);var h=s(l,2);h.__click=()=>Qe.mutate({projectName:t(i).name,forceRecreate:!0});var E=a(h);$r(E,{class:"w-3 h-3"}),r(h),_((z,Q)=>{k(l,"title",z),k(h,"title",Q)},[()=>o()("compose.up"),()=>o()("compose.forceRecreate")]),p(n,c)};C(Ze,n=>{(t(i).state===u.Down||t(i).state===u.Stopped||t(i).state===u.Exited||t(i).state===u.Degraded||t(i).state===u.Created)&&n(Mt)})}var Be=s(Ze,2);{var qt=n=>{var c=Tr(),l=F(c);l.__click=()=>dt.mutate(t(i).name);var b=a(l);st(b,{class:"w-4 h-4"}),r(l);var h=s(l,2);h.__click=()=>lt.mutate(t(i).name);var E=a(h);qe(E,{class:"w-4 h-4"}),r(h),_((z,Q)=>{k(l,"title",z),k(h,"title",Q)},[()=>o()("compose.restart"),()=>o()("compose.stop")]),p(n,c)};C(Be,n=>{(t(i).state===u.Running||t(i).state===u.Degraded)&&n(qt)})}var Et=s(Be,2);{var Qt=n=>{var c=Lr();c.__click=()=>xt(t(i));var l=a(c);it(l,{class:"w-4 h-4"}),r(c),_(b=>k(c,"title",b),[()=>o()("common.delete")]),p(n,c)};C(Et,n=>{t(i).state!==u.Down&&n(Qt)})}r(Ue),r(Z);var We=s(Z,2),Dt=a(We);{var Ft=n=>{var c=Mr(),l=a(c);r(c),_(b=>v(l,`${b??""}: ${t(i).path??""}`),[()=>o()("compose.directoryPath")]),p(n,c)};C(Dt,n=>{t(i).path&&n(Ft)})}r(We),r(S);var Kt=s(S,2);{var jt=n=>{var c=Dr(),l=a(c),b=a(l),h=a(b),E=a(h),z=a(E),Q=a(z),It=a(Q,!0);r(Q);var $e=s(Q),Nt=a($e,!0);r($e);var Se=s($e),Ot=a(Se,!0);r(Se);var Ce=s(Se),zt=a(Ce,!0);r(Ce);var Ge=s(Ce),At=a(Ge,!0);r(Ge),r(z),r(E);var He=s(E);at(He,21,()=>t(i).services,W=>W.id,(W,m)=>{var G=Qr(),H=a(G),J=a(H),Ut=a(J,!0);r(J);var Je=s(J,2),Zt=a(Je,!0);r(Je),r(H);var Re=s(H),Ve=a(Re),Bt=a(Ve,!0);r(Ve),r(Re);var Pe=s(Re),Wt=a(Pe);{let y=A(()=>Fe(t(m).state));ot(Wt,{get class(){return`${t(y)??""} text-xs px-2 py-0.5`},get status(){return t(m).state},size:"sm"})}r(Pe);var Te=s(Pe),Xe=a(Te),Gt=a(Xe,!0);r(Xe),r(Te);var Ye=s(Te),et=a(Ye),tt=a(et);{var Ht=y=>{var R=qr(),D=F(R);D.__click=()=>gt.mutate(t(m).id);var Le=a(D);st(Le,{class:"w-3 h-3"}),r(D);var ae=s(D,2);ae.__click=()=>ut.mutate(t(m).id);var Xt=a(ae);qe(Xt,{class:"w-3 h-3"}),r(ae),_((Yt,er)=>{k(D,"title",Yt),k(ae,"title",er)},[()=>o()("containers.restart"),()=>o()("containers.stop")]),p(y,R)},Jt=y=>{var R=Er();R.__click=()=>vt.mutate(t(m).id);var D=a(R);nt(D,{class:"w-3 h-3"}),r(R),_(Le=>k(R,"title",Le),[()=>o()("containers.start")]),p(y,R)};C(tt,y=>{t(m).state===u.Running?y(Ht):y(Jt,!1)})}var re=s(tt,2);re.__click=()=>ht(t(m));var Vt=a(re);it(Vt,{class:"w-3 h-3"}),r(re),r(et),r(Ye),r(G),_(y=>{v(Ut,t(m).name),v(Zt,t(m).id),v(Bt,t(m).image||"-"),v(Gt,t(m).status||"-"),k(re,"title",y)},[()=>o()("containers.remove")]),p(W,G)}),r(He),r(h),r(b),r(l),r(c),_((W,m,G,H,J)=>{v(It,W),v(Nt,m),v(Ot,G),v(zt,H),v(At,J)},[()=>o()("containers.name"),()=>o()("containers.image"),()=>o()("containers.state"),()=>o()("containers.status"),()=>o()("containers.actions")]),p(n,c)};C(Kt,n=>{t(q)&&t(i).services&&t(i).services.length>0&&n(jt)})}r(U),_(()=>{k(S,"aria-expanded",t(q)),Ae=nr(O,1,"inline-block transition-transform duration-150 ease-in-out text-gray-900 dark:text-white group-hover:text-blue-600 group-hover:dark:text-blue-400",null,Ae,{"rotate-90":t(q)}),v(Tt,t(i).name)}),p(M,U)}),r(L),p(N,L)};C(be,N=>{t(te).length===0?N(ye):N(Rt,!1)},!0)}p(j,I)};C($,j=>{ee.error?j(_e):j(fe,!1)},!0)}p(e,d)};C(wt,e=>{ee.isLoading?e($t):e(St,!1)})}r(ve);var Ct=s(ve,2);ur(Ct,{get open(){return t(f).open},get title(){return t(f).title},get description(){return t(f).description},get onconfirm(){return t(f).onConfirm},oncancel:()=>t(f).open=!1}),_((e,d,$,_e,fe)=>{v(_t,e),v(ft,d),v(bt,` ${$??""}`),v(kt,`${t(te).length??""} ${_e??""} ${fe??""}`)},[()=>o()("compose.projects"),()=>o()("compose.subtitle"),()=>o()("common.refresh"),()=>t(te).length===1?o()("settings.project").toLowerCase():o()("compose.projects").toLowerCase(),()=>o()("common.search").toLowerCase()]),p(ne,Ke),sr(),ce()}tr(["click","keydown"]);export{va as component};
